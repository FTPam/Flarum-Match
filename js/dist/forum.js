module.exports=function(t){var e={};function n(o){if(e[o])return e[o].exports;var a=e[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(o,a,function(e){return t[e]}.bind(null,a));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=12)}([function(t,e){t.exports=flarum.core.compat["forum/app"]},function(t,e){t.exports=flarum.core.compat["forum/components/DiscussionComposer"]},function(t,e){t.exports=flarum.core.compat["common/extend"]},,function(t,e){t.exports=flarum.core.compat["common/utils/classList"]},function(t,e){t.exports=flarum.core.compat["common/components/Button"]},function(t,e){t.exports=flarum.core.compat["common/components/Modal"]},function(t,e){t.exports=flarum.core.compat["components/TextEditor"]},function(t,e){t.exports=flarum.core.compat["components/TextEditorButton"]},function(t,e){t.exports=flarum.core.compat["common/components/Switch"]},function(t,e){t.exports=flarum.core.compat["common/utils/Stream"]},,function(t,e,n){"use strict";n.r(e);var o=n(0),a=n.n(o),i=n(2),s=n(4),r=n.n(s),c=n(1),l=n.n(c);n(7),n(8);function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var p=n(5),d=n.n(p),f=n(6),h=n.n(f),v=(n(9),n(10),dayjs().format("YYYY-MM-DD")),g=dayjs().format("HH:mm"),x=function(t){var e,n;function o(){for(var e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))||this).loading=!1,e.date=void 0,e.time=void 0,e}n=t,(e=o).prototype=Object.create(n.prototype),e.prototype.constructor=e,u(e,n);var i=o.prototype;return i.oninit=function(e){t.prototype.oninit.call(this,e),this.date=v,this.time=g,this.pickUpPoint="xm",this.destination="xm"},i.title=function(){return"发起拼车匹配"},i.className=function(){return"MatchDiscussionModal Modal--small"},i.configDatePicker=function(t){},i.content=function(){var t=this;return[m("div",{className:"Modal-body"},m("div",{className:"MatchDiscussionModal-form"},m("div",{className:"Form-group"},m("label",{className:"label"},"出发地点"),m("select",{class:"Select-input FormControl",value:this.pickUpPoint,onchange:function(e){return t.pickUpPoint=e.target.value}},m("option",{value:"xm"},"交大西门"),m("option",{value:"tf"},"天府国际机场"),m("option",{value:"sl"},"双流国际机场"),m("option",{value:"dz"},"成都东站"),m("option",{value:"nz"},"成都南站"))),m("div",{className:"Form-group"},m("label",{className:"label"},"到达地点"),m("select",{class:"Select-input FormControl",value:this.destination,onchange:function(e){return t.destination=e.target.value}},m("option",{value:"xm"},"交大西门"),m("option",{value:"tf"},"天府国际机场"),m("option",{value:"sl"},"双流国际机场"),m("option",{value:"dz"},"成都东站"),m("option",{value:"nz"},"成都南站"))),m("div",{className:"Form-group CreateMatchModal-timeDateGroup"},m("label",{class:"label"},"出发时间"),m("input",{name:"scheduledLeaveDate",class:"FormControl",type:"date",min:v,value:this.date,onchange:function(e){return t.date=e.target.value}}),m("input",{name:"scheduledLeaveTime",class:"FormControl",type:"time",value:this.time,onchange:function(e){return t.time=e.target.value}})),m("div",{className:"Form-group"},m("label",{className:"label"},"最长可等待 [单位：分钟,只填数字,最多720]"),m("input",{type:"text",class:"FormControl",value:this.maxWait,onchange:function(e){return t.maxWait=e.target.value},min:0})),m("div",{className:"Form-group"},m("label",{className:"label"},"你的性别"),m("select",{class:"Select-input FormControl",value:this.sex,onchange:function(e){return t.sex=e.target.value}},">",m("option",{value:"non"},"保密"),m("option",{value:"boy"},"男"),m("option",{value:"girl"},"女"))),m("div",{className:"Form-group"},m("label",{className:"label"},"联系方式（可匹配后自行沟通）"),m("input",{type:"text",class:"FormControl",value:this.contact,onchange:function(e){return t.contact=e.target.value}})),m("div",{className:"Form-group"},m("label",{className:"label"},"附加信息（非必填，支持Markdown）"),m("input",{type:"text",class:"FormControl",value:this.message,onchange:function(e){return t.message=e.target.value}})),m("div",{className:"Form-group"},d.a.component({type:"submit",className:"Button Button--primary MatchModal-SubmitButton",loading:this.loading},"开始匹配"))))]},i.getLocationName=function(t){switch(t){case"xm":return"交大西门";case"tf":return"天府国际机场";case"sl":return"双流国际机场";case"dz":return"成都东站";case"nz":return"成都南站"}},i.getSexName=function(t){switch(t){case"non":return"保密";case"boy":return"男";case"girl":return"女";default:return"未填写"}},i.onsubmit=function(t){if(t.preventDefault(),this.pickUpPoint&&this.destination)if(this.pickUpPoint!=this.destination)if(this.date&&this.time)if(this.time<g&&this.date<=v)window.alert("出发时间必须晚于当前时间");else if(isNaN(this.maxWait))window.alert("请在最长等待时间中填写阿拉伯数字");else if(this.maxWait<0||this.maxWait>720)window.alert("最长等待时间必须大于等于0, 小于等于720");else{var e="[拼车]"+this.date+" "+this.time+"["+this.getLocationName(this.pickUpPoint)+"]-["+this.getLocationName(this.destination)+"]",n="------\n#### 出发地点："+this.getLocationName(this.pickUpPoint)+"\n#### 到达地点："+this.getLocationName(this.destination)+"\n#### 出发时间："+this.date+" "+this.time+"\n#### 最多等待："+this.maxWait+"分钟\n------\n#### 性别："+this.getSexName(this.sex)+"\n------\n#### 联系方式：\n"+(this.contact?void 0:"未填写")+"\n#### 附加信息：\n"+(this.message?void 0:"未填写")+"\n ------- \n> ## 安全提醒!!!\n1. 建议您在拼车成功后，立即联系对方，并充分沟通上车时间、地点等问题，以确保拼车过程一切顺利。\n2. 论坛只能确认该账户绑定了交大邮箱，并不能确定该拼车申请是否由该邮箱账号的持有者发起。\n为了您的安全，请在联系上对方后，向对方索要学生证、一卡通的照片，或者其它基本个人信息，以进一步确认对方的本校学生身份。若对方拒不提供任何基本个人信息，或见面时，发现对方谎报个人信息，建议您立即停止拼车。\n3. 为了您的安全，请向您的朋友分享行程，路途中请保持清醒和警惕。\n4. 为了您的安全，请尽量选择滴滴、美团等知名网约车平台，不要乘坐没有资质的网约车。\n5. 如果行程中您受到了骚扰，请及时报警，并向论坛反映情况，我们会全力配合调查。\n\n> ## 注意事项：\n1. 建议您开启邮件通知，并在交大邮箱设置中，将所有邮件转发到你的常用邮箱，以便及时接收匹配信息。\n[点我，查看打开邮件通知的方法](https://mcfuntime.com/d/90/13)\n2. 匹配完成后，请及时为帖子设置最佳回复或删除帖子，以免重复匹配。\n3. 若在您的上车时间到达后仍未匹配成功，请删除您的帖子。之后若用户数量增多，我们会提供自动匹配服务，以提高匹配成功的概率。\n\n> ------- \n";console.log("update");var o={title:e,content:n,relationships:{tags:{data:{type:"tags",id:"4"}}}};console.log(JSON.stringify(o)),a.a.store.createRecord("discussions").save(o).then((function(t){a.a.discussions.refresh({deferClear:!0}),m.route.set(a.a.route.discussion(t))})),console.log(JSON.stringify(o)),a.a.composer.close()}else window.alert("请填写出发时间");else window.alert("出发地和目的地不能一样");else window.alert("请填写出发地和目的地")},o}(h.a);a.a.initializers.add("tpam/flarum-match",(function(){l.a.prototype.addMatch=function(){var t=this;new RegExp("^[0-9a-zA-Z_-].+@my.swjtu.edu\\.cn$").test(a.a.session.user.email())?a.a.modal.show(x,{poll:this.poll,onsubmit:function(e){return t.poll=e}}):window.alert("使用此功能，你需要先完成交大学生认证")},Object(i.extend)(l.a.prototype,"headerItems",(function(t){t.add("match",m("a",{className:"DiscussionComposer-match",onclick:this.addMatch.bind(this)},m("span",{className:r()("MatchLabel",!this.poll&&"none")},"发起拼车匹配")),2)}))}))}]);
//# sourceMappingURL=forum.js.map