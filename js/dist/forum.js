module.exports=function(t){var e={};function o(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,o),a.l=!0,a.exports}return o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=12)}([function(t,e){t.exports=flarum.core.compat["forum/app"]},function(t,e){t.exports=flarum.core.compat["forum/components/DiscussionComposer"]},function(t,e){t.exports=flarum.core.compat["common/extend"]},,function(t,e){t.exports=flarum.core.compat["common/utils/classList"]},function(t,e){t.exports=flarum.core.compat["common/components/Button"]},function(t,e){t.exports=flarum.core.compat["common/components/Modal"]},function(t,e){t.exports=flarum.core.compat["components/TextEditor"]},function(t,e){t.exports=flarum.core.compat["components/TextEditorButton"]},function(t,e){t.exports=flarum.core.compat["common/components/Switch"]},function(t,e){t.exports=flarum.core.compat["common/utils/Stream"]},,function(t,e,o){"use strict";o.r(e);var n=o(0),a=o.n(n),i=o(2),s=o(4),r=o.n(s),c=o(1),l=o.n(c);o(7),o(8);function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var p=o(5),d=o.n(p),f=o(6),h=o.n(f),v=(o(9),o(10),dayjs().format("YYYY-MM-DD")),g=dayjs().format("HH:mm"),x=function(t){var e,o;function n(){for(var e,o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).loading=!1,e.date=void 0,e.time=void 0,e}o=t,(e=n).prototype=Object.create(o.prototype),e.prototype.constructor=e,u(e,o);var i=n.prototype;return i.oninit=function(e){t.prototype.oninit.call(this,e),this.date=v,this.time=g,this.pickUpPoint="xm",this.destination="xm"},i.title=function(){return"发起拼车匹配"},i.className=function(){return"MatchDiscussionModal Modal--small"},i.configDatePicker=function(t){},i.content=function(){var t=this;return[m("div",{className:"Modal-body"},m("div",{className:"MatchDiscussionModal-form"},m("div",{className:"Form-group"},m("label",{className:"label"},"出发地点"),m("select",{class:"Select-input FormControl",value:this.pickUpPoint,onchange:function(e){return t.pickUpPoint=e.target.value}},m("option",{value:"xm"},"交大西门"),m("option",{value:"tf"},"天府国际机场"),m("option",{value:"sl"},"双流国际机场"),m("option",{value:"dz"},"成都东站"),m("option",{value:"nz"},"成都南站"))),m("div",{className:"Form-group"},m("label",{className:"label"},"到达地点"),m("select",{class:"Select-input FormControl",value:this.destination,onchange:function(e){return t.destination=e.target.value}},m("option",{value:"xm"},"交大西门"),m("option",{value:"tf"},"天府国际机场"),m("option",{value:"sl"},"双流国际机场"),m("option",{value:"dz"},"成都东站"),m("option",{value:"nz"},"成都南站"))),m("div",{className:"Form-group CreateMatchModal-timeDateGroup"},m("label",{class:"label"},"出发时间"),m("input",{name:"scheduledLeaveDate",class:"FormControl",type:"date",min:v,value:this.date,onchange:function(e){return t.date=e.target.value}}),m("input",{name:"scheduledLeaveTime",class:"FormControl",type:"time",value:this.time,onchange:function(e){return t.time=e.target.value}})),m("div",{className:"Form-group"},m("label",{className:"label"},"最长可等待 [单位：分钟,只填数字,最多720]"),m("input",{type:"text",class:"FormControl",value:this.maxWait,onchange:function(e){return t.maxWait=e.target.value},min:0})),m("div",{className:"Form-group"},m("label",{className:"label"},"你的性别"),m("select",{class:"Select-input FormControl",value:this.sex,onchange:function(e){return t.sex=e.target.value}},">",m("option",{value:"non"},"保密"),m("option",{value:"boy"},"男"),m("option",{value:"girl"},"女"))),m("div",{className:"Form-group"},m("label",{className:"label"},"联系方式（可匹配后自行沟通）"),m("input",{type:"text",class:"FormControl",value:this.contact,onchange:function(e){return t.contact=e.target.value}})),m("div",{className:"Form-group"},m("label",{className:"label"},"附加信息（非必填，支持Markdown）"),m("input",{type:"text",class:"FormControl",value:this.message,onchange:function(e){return t.message=e.target.value}})),m("div",{className:"Form-group"},d.a.component({type:"submit",className:"Button Button--primary MatchModal-SubmitButton",loading:this.loading},"开始匹配"))))]},i.getLocationName=function(t){switch(t){case"xm":return"交大西门";case"tf":return"天府国际机场";case"sl":return"双流国际机场";case"dz":return"成都东站";case"nz":return"成都南站"}},i.getSexName=function(t){switch(t){case"non":return"保密";case"boy":return"男";case"girl":return"女";default:return"未填写"}},i.onsubmit=function(t){if(t.preventDefault(),this.pickUpPoint&&this.destination)if(this.pickUpPoint!=this.destination)if(this.date&&this.time)if(this.time<g&&this.date<=v)window.alert("出发时间必须晚于当前时间");else if(isNaN(this.maxWait))window.alert("请在最长等待时间中填写阿拉伯数字");else if(this.maxWait<0||this.maxWait>720)window.alert("最长等待时间必须大于等于0, 小于等于720");else{this.date,this.time,this.getLocationName(this.pickUpPoint),this.getLocationName(this.destination),this.getLocationName(this.pickUpPoint),this.getLocationName(this.destination),this.date,this.time,this.maxWait,this.getSexName(this.sex),this.contact,this.message;console.log("update");var e={title:"title",content:"content",relationships:{tags:{data:[{type:"tags",id:"4"}]}}};console.log(JSON.stringify(e)),a.a.store.createRecord("discussions").save(e).then((function(t){a.a.discussions.refresh({deferClear:!0}),m.route.set(a.a.route.discussion(t))})),console.log(JSON.stringify(e)),l.a.close(),this.close()}else window.alert("请填写出发时间");else window.alert("出发地和目的地不能一样");else window.alert("请填写出发地和目的地")},n}(h.a);a.a.initializers.add("tpam/flarum-match",(function(){l.a.prototype.addMatch=function(){var t=this;new RegExp("^[0-9a-zA-Z_-].+@my.swjtu.edu\\.cn$").test(a.a.session.user.email())?a.a.modal.show(x,{poll:this.poll,onsubmit:function(e){return t.poll=e}}):window.alert("使用此功能，你需要先完成交大学生认证")},Object(i.extend)(l.a.prototype,"headerItems",(function(t){t.add("match",m("a",{className:"DiscussionComposer-match",onclick:this.addMatch.bind(this)},m("span",{className:r()("MatchLabel",!this.poll&&"none")},"发起拼车匹配")),2)}))}))}]);
//# sourceMappingURL=forum.js.map